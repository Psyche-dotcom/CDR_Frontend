function GetTop(){var t=$(".DetailTimesFilter.active").attr("data-item"),n=CompanyPersonFilterPost.find(n=>n.type===1&&n.time===t);n==undefined?(SetCardOverlay($("#numofanswered").closest(".card")),SetCardOverlay($("#totalcalls").closest(".card")),SetCardOverlay($("#numofmissed").closest(".card")),SetCardOverlay($("#totaltalktime").closest(".card")),$.post("/data/person-detail-top",{no:$("#ExtNo").val(),f:t},function(n){$("#numofanswered").html(n.numofanswered);$("#totalcalls").html(n.numofcalls);$("#numofmissed").html(n.numofmissed);$("#totaltalktime").html(n.totaltalktime);$("#totalcalls-progress").attr("aria-valuenow",n.numofcalls);$("#totalcalls-progress").attr("aria-valuemin",0);$("#totalcalls-progress").attr("aria-valuemax",1e3);$("#totalcalls-progress").css("width",n.numofcalls/10+"%");$("#totaltalktime-progress").attr("aria-valuenow",n.totalminutes);$("#totaltalktime-progress").attr("aria-valuemin",0);$("#totaltalktime-progress").attr("aria-valuemax",500);$("#totaltalktime-progress").css("width",n.totalminutes/5+"%");$("#numofanswered-progress").attr("aria-valuenow",n.numofanswered);$("#numofanswered-progress").attr("aria-valuemin",0);$("#numofanswered-progress").attr("aria-valuemax",1e3);$("#numofanswered-progress").css("width",n.numofanswered/10+"%");$("#numofmissed-progress").attr("aria-valuenow",n.numofmissed);$("#numofmissed-progress").attr("aria-valuemin",0);$("#numofmissed-progress").attr("aria-valuemax",1e3);$("#numofmissed-progress").css("width",n.numofmissed/10+"%");CompanyPersonFilterPost.push({type:1,time:t,data:n});RemoveCardOverlay($("#numofanswered").closest(".card"));RemoveCardOverlay($("#totalcalls").closest(".card"));RemoveCardOverlay($("#numofmissed").closest(".card"));RemoveCardOverlay($("#totaltalktime").closest(".card"))})):($("#numofanswered").html(n.data.numofanswered),$("#totalcalls").html(n.data.numofcalls),$("#numofmissed").html(n.data.numofmissed),$("#totaltalktime").html(n.data.totaltalktime),$("#totalcalls-progress").attr("aria-valuenow",n.data.numofcalls),$("#totalcalls-progress").attr("aria-valuemin",0),$("#totalcalls-progress").attr("aria-valuemax",1e3),$("#totalcalls-progress").css("width",n.data.numofcalls/10+"%"),$("#totaltalktime-progress").attr("aria-valuenow",n.data.totalminutes),$("#totaltalktime-progress").attr("aria-valuemin",0),$("#totaltalktime-progress").attr("aria-valuemax",500),$("#totaltalktime-progress").css("width",n.data.totalminutes/5+"%"),$("#numofanswered-progress").attr("aria-valuenow",n.data.numofanswered),$("#numofanswered-progress").attr("aria-valuemin",0),$("#numofanswered-progress").attr("aria-valuemax",1e3),$("#numofanswered-progress").css("width",n.data.numofanswered/10+"%"),$("#numofmissed-progress").attr("aria-valuenow",n.data.numofmissed),$("#numofmissed-progress").attr("aria-valuemin",0),$("#numofmissed-progress").attr("aria-valuemax",1e3),$("#numofmissed-progress").css("width",n.data.numofmissed/10+"%"))}function GetTopSixConversationNumber(){var n=$(".DetailTimesFilter.active").attr("data-item"),t=CompanyPersonFilterPost.find(t=>t.type===2&&t.time===n);t==undefined?(SetCardOverlay($("#TopSixConversationNumber").closest(".card")),$.post("/data/person-detail-conversation-number",{no:$("#ExtNo").val(),f:n},function(t){$("#TopSixConversationNumber").html(t);CompanyPersonFilterPost.push({type:2,time:n,data:t});RemoveCardOverlay($("#TopSixConversationNumber").closest(".card"))})):$("#TopSixConversationNumber").html(t.data)}function GetTopSixConversationTime(){var n=$(".DetailTimesFilter.active").attr("data-item"),t=CompanyPersonFilterPost.find(t=>t.type===3&&t.time===n);t==undefined?(SetCardOverlay($("#TopSixConversationTime").closest(".card")),$.post("/data/person-detail-conversation-time",{no:$("#ExtNo").val(),f:n},function(t){$("#TopSixConversationTime").html(t);CompanyPersonFilterPost.push({type:3,time:n,data:t});RemoveCardOverlay($("#TopSixConversationTime").closest(".card"))})):$("#TopSixConversationTime").html(t.data)}function GetTopSixAnsweredNumber(){var n=$(".DetailTimesFilter.active").attr("data-item"),t=CompanyPersonFilterPost.find(t=>t.type===4&&t.time===n);t==undefined?(SetCardOverlay($("#TopSixAnsweredNumber").closest(".card")),$.post("/data/person-detail-answered-number",{no:$("#ExtNo").val(),f:n},function(t){$("#TopSixAnsweredNumber").html(t);CompanyPersonFilterPost.push({type:4,time:n,data:t});RemoveCardOverlay($("#TopSixAnsweredNumber").closest(".card"))})):$("#TopSixAnsweredNumber").html(t.data)}function GetTopSixMissedNumber(){var n=$(".DetailTimesFilter.active").attr("data-item"),t=CompanyPersonFilterPost.find(t=>t.type===5&&t.time===n);t==undefined?(SetCardOverlay($("#TopSixMissedNumber").closest(".card")),$.post("/data/person-detail-missed-number",{no:$("#ExtNo").val(),f:n},function(t){$("#TopSixMissedNumber").html(t);CompanyPersonFilterPost.push({type:5,time:n,data:t});RemoveCardOverlay($("#TopSixMissedNumber").closest(".card"))})):$("#TopSixMissedNumber").html(t.data)}var Dt,CompanyPersonFilterPost;$(function(){GetTop();GetTopSixConversationNumber();GetTopSixAnsweredNumber();GetTopSixMissedNumber();GetTopSixConversationTime();$(".datetimepicker").datetimepicker({format:"Y.m.d",timepicker:!1})});Dt=$("#CallInfoTable").DataTable({processing:!0,pageLength:10,ajax:{url:"/data/person-detail-call-info",type:"POST",datatype:"json",data:function(n){n.no=$("#ExtNo").val();n._f=$(".call-info-filter .nav-link.active").attr("data-type");n.sd=$("#StartDate").val();n.ed=$("#EndDate").val()},dataSrc:function(n){for(var r,i=[],t=0;t<n.length;t++)r={call_id:n[t].call_id,from:n[t].tablecolumnfrom,to:n[t].tablecolumnto,inorout:n[t].tablecolumninorout,durationstring:n[t].tablecolumnduration,talktimestring:n[t].tablecolumntalktime,ringtimestring:n[t].tablecolumnringtime,date:n[t].tablecolumndate,starttimestring:n[t].tablecolumnstarttime,stoptimestring:n[t].tablecolumnstoptime,status:n[t].tablecolumnstatus,button:n[t].tablecolumnbutton},i.push(r);return i}},columns:[{data:"call_id",visible:!1},{data:"date"},{data:"starttimestring"},{data:"from"},{data:"to"},{data:"inorout"},{data:"durationstring"},{data:"talktimestring"},{data:"ringtimestring"},{data:"stoptimestring"},{data:"status"},{data:"button"}],fnDrawCallback:function(){$(".call-info-filter a").removeClass("disabled-button")},responsive:!0,autoWidth:!1,bLengthChange:!1,order:[[0,"desc"]],language:{sEmptyTable:Localization.sEmptyTable,sInfo:Localization.sInfo,sInfoEmpty:Localization.sInfoEmpty,sInfoFiltered:Localization.sInfoFiltered,sLengthMenu:Localization.sLengthMenu,sLoadingRecords:Localization.sLoadingRecords,sSearch:Localization.sSearch,sZeroRecords:Localization.sZeroRecords,oPaginate:{sFirst:Localization.sFirst,sLast:Localization.sLast,sNext:Localization.sNext,sPrevious:Localization.sPrevious}},oLanguage:{sProcessing:'<span class="load load-button"><\/span>'}});$(".exportExcel").click(function(){var i=$("#ExtNo").val(),r=$(".call-info-filter .nav-link.active").attr("data-type"),u=$("#StartDate").val(),f=$("#EndDate").val(),t="/ajax/excel-export-person-detail-calls",n=!0;i!=null&&i.length>0&&(t+=(n?"?":"&")+"no="+i,n=!1);r!=null&&r.length>0&&(t+=(n?"?":"&")+"f="+r,n=!1);u!=null&&u.length>0&&(t+=(n?"?":"&")+"sd="+u,n=!1);f!=null&&f.length>0&&(t+=(n?"?":"&")+"ed="+f,n=!1);window.open(t,"_blank")});$(".customizer-toggle").on("click",function(){$(".customizer").toggleClass("open")});$(".customizer-close").on("click",function(){$(".customizer").removeClass("open")});CompanyPersonFilterPost=[];$(".DetailTimesFilter").click(function(){var n=$(this);$(".DetailTimesFilter").removeClass("active");n.addClass("active");GetTop();GetTopSixConversationNumber();GetTopSixConversationTime();GetTopSixAnsweredNumber();GetTopSixMissedNumber()});$(".call-info-filter a").click(function(){$(".call-info-filter a").addClass("disabled-button");setTimeout(function(){Dt.ajax.reload()},300)});