function checkfile(n){var t=n.value;return t=t.substring(t.lastIndexOf(".")),[".xlsx",".xls"].indexOf(t)<0?($("#file").val(""),alert(Localization.ExcelFormatindaDosyaYukle),!1):!0}$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip()});var Dt=$("#DataList").DataTable({serverSide:!0,orderMulti:!1,processing:!0,pageLength:20,searching:!1,ajax:{url:"/data/company-phone-book-list",type:"POST",datatype:"json",data:function(n){n.namesurname=$("#NameSurname").val();n.email=$("#Email").val();n.phone=$("#Phone").val()}},columns:[{data:"firstname"},{data:"lastname"},{data:"tableemail"},{data:"tablephone"},{data:"tablecompany"}],fnDrawCallback:function(){},createdRow:function(n,t){$(n).addClass("phonebookrow-"+t.idphonebook)},bLengthChange:!1,language:{sEmptyTable:Localization.sEmptyTable,sInfo:Localization.sInfo,sInfoEmpty:Localization.sInfoEmpty,sInfoFiltered:Localization.sInfoFiltered,sLengthMenu:Localization.sLengthMenu,sLoadingRecords:Localization.sLoadingRecords,sSearch:Localization.sSearch,sZeroRecords:Localization.sZeroRecords,oPaginate:{sFirst:Localization.sFirst,sLast:Localization.sLast,sNext:Localization.sNext,sPrevious:Localization.sPrevious}},oLanguage:{sProcessing:'<span class="load load-button"><\/span>'},responsive:!0,autoWidth:!1});$("#AddExcel").click(function(){var i,t,r;if($("#ExportModal").modal("hide"),$(".PostLoader").show(),i=["xls","xlsx"],t=$("#file").val(),t.length==0)return toastr.error(Localization.DosyaSeciniz,Localization.Error),$(".PostLoader").hide(),!1;if(r=t.replace(/^.*\./,""),$.inArray(r,i)==-1)return toastr.error(Localization.SadeceExcelDosyasiSec,Localization.Error),$(".PostLoader").hide(),!1;var n=new FormData,f=$("#file").get(0),u=f.files;n.append(u[0].name,u[0]);$.ajax({xhr:function(){var n=new window.XMLHttpRequest;return n.upload.addEventListener("progress",function(n){if($(".progress").show(),$(".progress").html(' <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0">0%<\/div>'),n.lengthComputable){var t=n.loaded/n.total;console.log(t);$(".progress-bar").css({width:t*100+"%"});$(".progress-bar").html(t*100+"%")}},!1),n},type:"POST",url:"/ajax/excel-import-phone-book",data:n,contentType:!1,processData:!1,success:function(t){t.success?($(".PostLoader").hide(),toastr.success(t.message,Localization.Success),n=new FormData,Dt.ajax.reload(),$("#file").val(null)):($(".PostLoader").hide(),toastr.error(t.message,Localization.Error),n=new FormData,$("#ExportModal").modal("show"))},error:function(){}})});$("#Filter").click(function(){Dt.ajax.reload()});$(".exportExcel").click(function(){var i=$("#NameSurname").val(),r=$("#Email").val(),u=$("#Phone").val(),t="/ajax/excel-export-phone-book",n=!0;i!=null&&i.length>0&&(t+=(n?"?":"&")+"NameSurname="+i,n=!1);r!=null&&r.length>0&&(t+=(n?"?":"&")+"Email="+r,n=!1);u!=null&&u.length>0&&(t+=(n?"?":"&")+"Phone="+u,n=!1);window.open(t,"_blank")});$("#DataList tbody").on("click","tr",function(){$(this).toggleClass("selected")});$(".deleteRows").click(function(){var n=Dt.rows(".selected").data(),t;if(n.length==0)return!1;t=Localization.VeriSilmeyeEminMisiniz.replace("-_Replace_-",Dt.rows(".selected").data().length);swal({title:Localization.AreYouSure,text:t,type:"warning",showCancelButton:!0,cancelButtonText:Localization.Cancel,confirmButtonColor:"#DD6B55",confirmButtonText:Localization.Sil,closeOnConfirm:!1},function(t){var r,i;if(!t)return!1;for(r=[],i=0;i<n.length;i++)r.push(n[i].idphonebook);$.post("/ajax/delete-phone-book",{Ids:r},function(n){n.success?(toastr.success(n.message,Localization.Success),Dt.ajax.reload()):toastr.error(n.message,Localization.Error);swal.close()})})});$(".import-excel").click(function(){$("#ExportModal").modal("show")});$(".create-user-modal").click(function(){$("#create-user-id").val("");$("#CreateUserName").val("");$("#CreateUserSurname").val("");$("#CreateUserEmail").val("");$("#CreateUserMobile").val("");$("#CreateUserCompany").val("");$("#create-user-modal").modal("show")});$("#CreateUserButton").click(function(){$("#create-user-modal").modal("hide");$(".page-loader-wrapper").show();var n={FirstName:$("#CreateUserName").val(),LastName:$("#CreateUserSurname").val(),Email:$("#CreateUserEmail").val(),MobileNumber:$("#CreateUserMobile").val(),Company:$("#CreateUserCompany").val(),idphonebook:$("#create-user-id").val()};$.post("/ajax/create-user-phone-book",n,function(n){$(".page-loader-wrapper").hide();n.success?(toastr.success(n.message,Localization.Success),Dt.ajax.reload()):(toastr.error(n.message,Localization.Error),setTimeout(function(){$("#create-user-modal").modal("show")},300))})});$(".update-user-modal").click(function(){var n=Dt.rows(".selected").data(),t;if(n.length==0)return!1;if(n.length>1)return toastr.error(Localization.Adet1KisiSec,Localization.Error),!1;t=n[0].idphonebook;$.post("/data/phone-book-user-detail",{Id:t},function(n){n.success?($("#create-user-id").val(n.resultObj.idphonebook),$("#CreateUserName").val(n.resultObj.firstname),$("#CreateUserSurname").val(n.resultObj.lastname),$("#CreateUserEmail").val(n.resultObj.email),$("#CreateUserMobile").val(n.resultObj.phonenumber),$("#CreateUserCompany").val(n.resultObj.company),$("#create-user-modal").modal("show")):toastr.error(n.message,Localization.Error)})});